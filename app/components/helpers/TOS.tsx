'use client'

import React, { useState, useEffect } from 'react';
import { X, AlertCircle, ExternalLink } from 'lucide-react';

class PrivacyPolicy {
  static content = `privacy policy

Cookies Policy, Privacy Policy and POPIA disclaimer

Cookie policy
We use cookies to make your experience with us better. By continuing to use our website without changing the settings, you are agreeing to our use of cookies.

introduction
Need to Fuel Proprietary Limited (NtF or we) respects the right to privacy and confidentiality and is committed to protecting your privacy, by ensuring that your personal information is collected and processed properly, lawfully and transparently. We subscribe to the conditions of the Protection of Personal Information Act (POPIA) to ensure that you are always protected when providing us with personal information.

This Privacy Statement serves as a notification to you as required by Section 18 of POPIA, it explains the steps we take to protect personal information we collect and is addressed to you as a customer, business partner and a user of our website or business processes. The Privacy Policy is available at https://www.needtofuel.com (Website). It describes the manner in which we collect, process, store, use and protect personal information which we collect, the purposes for which we use it, your rights regarding your personal information, our security measures, and how you can review and correct your personal information.

data collection
When used in this Privacy Policy, the term "personal information" has the meaning given to it in the POPIA. Generally speaking, personal information is any information relating to an identifiable, living natural person or an existing juristic person. If any information that we collect personally identifies you, or you are reasonably identifiable from it, we will treat it as personal information.

We will collect your personal information in a number of ways, including:
• directly from you (where it is practicable to do so);
• from third parties including employers, authorised representatives, agents or third parties who are authorised to share personal information, and publicly available sources of information; and
• from third parties (some of whom may be our agents) who have identified you as someone who may wish to purchase our products or provide services to NtF.

In the course of business engagements, promotional competitions and on some pages of our Website, we may ask you for personal information for the purpose of entering into a business or employment relationship, providing a service, conducting a promotional competition or carrying out a transaction requested by you. The personal information that we collect and process will be provided by you voluntarily and may include:
• contact details, such as your name, title, company/organization name, email address, telephone and fax numbers, and physical address;
• information about your company and job position;
• information about your company directors, officers, employees, beneficial owners or other associated individuals your preferences with respect to email marketing;
• financial information, including credit card numbers, bank or customer account information and, in connection with credit requests, identity number or other national/tax identification number;
• your gender or marital status;
• in certain instances, sensitive personal information may be required, for example, race or ethnicity, medical information, criminal information, employment information and beliefs;
• information such as your nationality and country of residence that allows us to determine your eligibility under export control regulations to receive information about certain technologies;
• your enquiries about and orders for our products and services, as well as information that assists us in identifying the best products and services for you;
• we may monitor and record telephone calls you make to us, unless you specifically request us not to;
• competition entry and event registration information; and
• surveys or feedback from you about our products and services, including our Website.

You are not required to provide this information. However, if you choose not to, we may not be able to provide you the requested service or complete your transaction. If you provide us with personal information of third parties, please make sure that you are authorised to do so.

AUTOMATIC COLLECTION OF DATA
We collect certain data about all visitors to our Website, including what pages they view, the number of bytes transferred, the links they click, and other actions taken within our Website. When you browse our Website, we may also collect information about your computer and your visits to our Website such as your IP address, geographical location, browser type, computing device for example tablet, personal computer, web-enabled phone, the website you came from, length of visit and number of page views. We use this information to better understand how visitors use our Website and how they can be improved to better meet your needs, as well as to gauge interest in our products and services and to improve our security measures. In some cases, when you click on a link in an email or submit a web form such as to request more information, like product or promotional information we can link this data to your email address.

Our use of personal information
We will use and process personal information only for the purposes set forth below.

Business Engagements - We use personal information for proposed and actual transactions, to enter into contracts, to support our procurement and on-boarding processes, including complying with our internal policies (particularly policies designed to prevent money laundering and sanctions violations).

Services and transactions - We use personal information to deliver services or execute transactions you request, such as providing information about NtF's products and services, processing orders, answering customer service requests, facilitating use of our Website, and so forth. In order to offer you a more consistent experience in interacting with NtF, information collected by our Website may be combined with information we collect by other means.

Website improvement - We may use personal information about you to improve our Website (including our security measures) and related products or services, or to make our Website easier to use by eliminating the need for you to repeatedly enter the same information, or by customizing our Website to your particular preference or interests.

Marketing Communications - We may use personal information to inform you of products or services available from NtF. You will receive marketing communications from us if you have requested information from us or if you have previously purchased products from us or made use of our services and you have not opted out of receiving such marketing.

Our use of cookies
Cookies are small files that websites save to your hard disk or to your browser's memory. Our Website may use them to track the number of times you have visited the Website, to track the number of visitors to the Website, to determine and analyse visitors' use of our Website, to store data that you provide (such as your preferences), and to store technical information related to your interactions with our Website. We may also use session cookies, to store your user ID, to facilitate your movement around our Website (particularly in connection with information searches and order placement) and other information useful in administering the session.

Most Internet browsers automatically accept cookies, but you can usually modify your browser settings to decline cookies or to notify you when a cookie is being placed on your computer. If you choose not to accept cookies, you may not be able to experience all of the features of our Website. Internet browsers also enable you to delete existing cookies, although this means that your existing settings (including stored user IDs and other preferences) will be lost.

Disclosure of personal information
Except as described below, personal information that you provide to NtF via our Website or any other means will not be shared outside of NtF without your consent. Access to personal information is only authorised for those employees who require it to fulfil their job responsibilities.

Disclosure to service providers - NtF contracts with other companies to provide services on our behalf, such as outsourcing, hosting websites, sending out information, processing transactions and analysing our Website. We provide these companies with only those elements of personal information they need to deliver those services. These companies and their employees are prohibited from using this personal information for any other purposes.

Disclosure in connection with transactions - In connection with certain transactions, we may disclose some or all of the personal information you provide, to financial institutions, government entities and shipping companies or postal services involved in fulfilling the transaction.

Disclosure for other reasons - We may disclose personal information if required to do so by law or in the good-faith belief that such action is necessary to comply with legal requirements or with legal process served on us, to protect and defend our rights or property, or in urgent circumstances to protect the personal safety of any individual.

Where appropriate, we ask third parties to whom personal information is disclosed to use and process your personal information in accordance with any laws applicable to the protection of personal information.

Security
NtF is committed to protecting the security of personal information. While no security measure can guarantee against compromise, we use a variety of security technologies and procedures to help protect personal information from unauthorized access, use, or disclosure.

For sites to which you log in, it is your responsibility to ensure the security of your password and to not reveal this information to others. If you are sharing a computer with anyone, you should always log out before leaving a website so that subsequent users will not be able to access your personal information.

Questions about our privacy practices
If you have questions regarding this Privacy Statement or our handling of personal information, please contact us by email at support@needtofuel.com.

Changes to this privacy POLICY
We may occasionally update this Privacy POLICY. You should revisit this page periodically to become aware of the most recent terms.

Acceptance
By accepting this Privacy POLICY, you are deemed to have read, understood, accepted, and agreed to be bound by all of its terms.`;
}

const TOS_: React.FC = () => {
  const [showTOS, setShowTOS] = useState<boolean>(true);
  const [accepted, setAccepted] = useState<boolean>(false);
  const [showFullTerms, setShowFullTerms] = useState<boolean>(false);
  const [isLoading, setIsLoading] = useState<boolean>(false);
  
  useEffect(() => {
    const hasAccepted = localStorage.getItem('tosAccepted');
    if (hasAccepted === 'true') {
      setShowTOS(false);
      setAccepted(true);
    }
  }, []);

  const handleAccept = async (): Promise<void> => {
    setIsLoading(true);
    await new Promise(resolve => setTimeout(resolve, 800));
    localStorage.setItem('tosAccepted', 'true');
    setShowTOS(false);
    setAccepted(true);
    setIsLoading(false);
  };

  const formatBulletPoints = (text: string): string => {
    return text.replace(/•/g, '•  ').replace(/\n•/g, '\n      •');
  };

  const TermsContent: React.FC = () => {
    const sections = PrivacyPolicy.content.split(/(?=\n[A-Za-z][A-Za-z\s\-]+\n)/);

    return (
      <div className="space-y-8">
        {sections.map((section, index) => {
          const lines = section.trim().split('\n');
          const title = lines[0];
          const content = formatBulletPoints(lines.slice(1).join('\n')).trim();

          return (
            <section key={index} className="pb-6 border-b border-gray-200 last:border-b-0">
              <h3 className="text-lg font-semibold text-gray-900 mb-4">
                {title}
              </h3>
              <div className="text-gray-600 leading-relaxed whitespace-pre-wrap">
                {content}
              </div>
            </section>
          );
        })}
      </div>
    );
  };

  const AcceptanceModal: React.FC = () => (
    <div className={`fixed inset-0 bg-black/40 z-50 flex items-center justify-center transition-opacity duration-200 ${showTOS ? 'opacity-100' : 'opacity-0 pointer-events-none'}`}>
      <div className="bg-white rounded w-full max-w-lg mx-4 shadow-xl">
        <div className="px-6 py-4 border-b border-gray-200">
          <h2 className="text-xl font-semibold text-gray-900">Privacy Policy Agreement</h2>
        </div>
        
        <div className="p-6">
          <div className="bg-gray-50 border border-gray-200 rounded p-4 mb-6">
            <p className="text-sm text-gray-600">
              Before proceeding, please review and accept our Privacy Policy. This document outlines how we collect, use, and protect your personal information.
            </p>
          </div>
          
          <div className="flex items-start space-x-3 mb-6">
            <input
              type="checkbox"
              id="terms"
              className="mt-1 w-4 h-4 rounded border-gray-300 text-gray-700 focus:ring-gray-500"
              checked={accepted}
              onChange={(e: React.ChangeEvent<HTMLInputElement>) => setAccepted(e.target.checked)}
            />
            <label htmlFor="terms" className="text-sm text-gray-600 leading-relaxed cursor-pointer">
              I have read and agree to the Privacy Policy
            </label>
          </div>
        </div>
        
        <div className="px-6 py-4 bg-gray-50 border-t border-gray-200 flex justify-between items-center">
          <button
            onClick={() => setShowFullTerms(true)}
            className="text-sm text-gray-600 hover:text-gray-900 flex items-center gap-1.5 transition-colors"
          >
            <ExternalLink className="w-4 h-4" />
            View Full Policy
          </button>
          
          <button
            onClick={handleAccept}
            disabled={!accepted || isLoading}
            className={`px-6 py-2 rounded text-sm font-medium transition-colors
              ${accepted && !isLoading
                ? 'bg-gray-900 hover:bg-gray-800 text-white'
                : 'bg-gray-200 text-gray-400 cursor-not-allowed'
              }`}
          >
            {isLoading ? (
              <svg className="animate-spin h-5 w-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                <circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4"></circle>
                <path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
              </svg>
            ) : (
              'Accept and Continue'
            )}
          </button>
        </div>
      </div>
    </div>
  );

  const FullTermsModal: React.FC = () => (
    <div className={`fixed inset-0 bg-black/40 z-50 flex items-center justify-center transition-opacity duration-200 ${showFullTerms ? 'opacity-100' : 'opacity-0 pointer-events-none'}`}>
      <div className="bg-white rounded w-full max-w-4xl mx-4 h-[80vh] flex flex-col shadow-xl">
        <div className="px-6 py-4 border-b border-gray-200 flex justify-between items-center">
          <h2 className="text-xl font-semibold text-gray-900">Privacy Policy</h2>
          <button
            onClick={() => setShowFullTerms(false)}
            className="text-gray-400 hover:text-gray-600 transition-colors"
          >
            <X className="w-5 h-5" />
          </button>
        </div>
        
        <div className="overflow-y-auto flex-grow p-6">
          <TermsContent />
        </div>
      </div>
    </div>
  );

  const WarningAlert: React.FC = () => (
    <div className={`fixed bottom-0 left-0 right-0 p-4 transition-transform duration-200 ${accepted ? 'translate-y-full' : 'translate-y-0'}`}>
      <div className="bg-white border border-gray-200 p-4 rounded shadow-lg max-w-2xl mx-auto">
        <div className="flex items-center">
          <AlertCircle className="h-5 w-5 text-gray-400" />
          <p className="ml-3 text-sm text-gray-600">
            Please accept the Privacy Policy to continue using the site.
          </p>
        </div>
      </div>
    </div>
  );

  return (
    <>
      <AcceptanceModal />
      <FullTermsModal />
      <WarningAlert />
    </>
  );
};

export default TOS_;